/* Make a copy of the production database and then run the script on the database copy.After script
is run take the dump of this database and name it as dest.sql*/


alter table recur_on_day DROP FOREIGN KEY recur_on_day_ibfk_1;
alter table recurrence_detail DROP FOREIGN KEY recurrence_detail_ibfk_2;
alter table customer DROP FOREIGN KEY customer_ibfk_6;
alter table customer_meeting DROP FoREIGN KEY customer_meeting_ibfk_2;
alter table loan_account DROP FoREIGN KEY loan_account_ibfk_8;
truncate table account_activity;
truncate table account_custom_field;
truncate table account_flag_detail;
truncate table account_notes;
truncate table account_status_change_history;
truncate table admin_document;
truncate table admin_document_acc_state_mix;
truncate table attendance;
truncate table batch_branch_cash_confirmation_report;
truncate table batch_branch_confirmation_disbursement;
truncate table batch_branch_confirmation_issue;
truncate table batch_branch_confirmation_recovery;
truncate table batch_branch_report;
truncate table batch_client_summary;
truncate table batch_job_execution;
truncate table batch_job_execution_context;
truncate table batch_job_instance;
truncate table batch_job_params;
truncate table batch_loan_arrears_aging;
truncate table batch_loan_arrears_profile;
truncate table batch_loan_details;
truncate table batch_staff_summary;
truncate table batch_staffing_level_summary;
truncate table batch_step_execution;
truncate table batch_step_execution_context;
truncate table branch_ho_update;
truncate table calculated_interest_on_payment;
truncate table cash_flow;
truncate table cash_flow_detail;
truncate table checklist;
truncate table checklist_detail;
truncate table client_initial_savings_offering;
truncate table client_perf_history;
truncate table coa_idmapper;
truncate table cust_perf_history;
truncate table customer_account;
truncate table customer_account_activity;
truncate table customer_address_detail;
truncate table customer_attendance;
truncate table customer_checklist;
truncate table customer_custom_field;
truncate table customer_detail;
truncate table customer_family_detail;
truncate table customer_fee_schedule;
truncate table customer_flag_detail;
truncate table customer_hierarchy;
truncate table customer_historical_data;
truncate table customer_loan_account_detail;
delete from meeting where meeting_id in (select meeting_id from customer_meeting);
delete from meeting where meeting_id in (select meeting_id from loan_account);
delete from recurrence_detail where meeting_id not in (select meeting_id from meeting);
delete from recur_on_day where details_id not in (select details_id from recurrence_detail);
truncate table customer_meeting;
truncate table customer_meeting_detail;
truncate table customer_movement;
truncate table customer_name_detail;
truncate table customer_note;
truncate table customer_picture;
truncate table customer_position;
truncate table customer_program;
truncate table customer_fee_schedule;
truncate table customer_trxn_detail;
truncate table fee_trxn_detail;
truncate table financial_trxn;
truncate table freq_of_deposits;
truncate table group_loan_counter;
truncate table group_perf_history;
truncate table holiday;
truncate table imported_transactions_files;
truncate table inherited_meeting;
truncate table insurance_offering;
truncate table loan_activity_details;
truncate table loan_amount_from_last_loan;
truncate table loan_amount_from_loan_cycle;
truncate table loan_arrears_aging;
truncate table loan_cash_flow;
truncate table loan_counter;
truncate table loan_fee_schedule;
truncate table loan_penalty;
truncate table loan_perf_history;
truncate table loan_fee_schedule;
truncate table loan_schedule;
truncate table loan_summary;
truncate table loan_trxn_detail;
truncate table max_min_interest_rate;
truncate table max_min_loan_amount;
truncate table max_min_no_of_install;
truncate table monthly_cash_flow_details;
truncate table no_of_install_from_last_loan;
truncate table no_of_install_from_loan_cycle;
truncate table offering_fund;
truncate table office_hierarchy;
truncate table office_holiday;
truncate table original_loan_fee_schedule;
truncate table original_loan_schedule;
truncate table ppi_likelihoods;
truncate table ppi_survey_instance;
truncate table program;
truncate table program_fund;
truncate table qrtz_blob_triggers;
truncate table qrtz_calendars;
truncate table qrtz_cron_triggers;
truncate table qrtz_fired_triggers;
truncate table qrtz_job_details;
truncate table qrtz_job_listeners;
truncate table qrtz_paused_trigger_grps;
truncate table qrtz_scheduler_state;
truncate table qrtz_simple_triggers;
truncate table qrtz_trigger_listeners;
truncate table qrtz_triggers;
truncate table question_choice_tags;
truncate table question_group_response;
truncate table report_datasource;
truncate table report_parameter;
truncate table report_parameter_map;
truncate table saving_schedule;
truncate table savings_activity_details;
truncate table savings_offering_historical_interest_detail;
truncate table savings_performance;
truncate table savings_trxn_detail;
truncate table scheduled_tasks;
truncate table survey_response;
truncate table survey_instance;
truncate table temp_id;
truncate table variable_installment_details;
truncate table waive_off_history;
truncate table question_group_instance;
truncate table account_trxn;
truncate table account_payment;
truncate table customer_schedule;
truncate table account_fees;
truncate table loan_account;
truncate table savings_account;
truncate table account;
truncate table customer;
ALTER TABLE recur_on_day ADD CONSTRAINT recur_on_day_ibfk_1  FOREIGN KEY (details_id) references recurrence_detail(details_id);
ALTER TABLE recurrence_detail ADD CONSTRAINT recurrence_detail_ibfk_2  FOREIGN KEY (meeting_id) references meeting(meeting_id);
ALTER TABLE customer ADD CONSTRAINT customer_ibfk_6  FOREIGN KEY (parent_customer_id) references customer(customer_id);
ALTER TABLE customer_meeting ADD CONSTRAINT customer_meeting_ibfk_2  FOREIGN KEY (meeting_id) references meeting(meeting_id);
ALTER TABLE loan_account ADD CONSTRAINT loan_account_ibfk_8  FOREIGN KEY (meeting_id) references meeting(meeting_id);
